# Git的使用

## 版本

### 概念

版本最早使用在书籍，刻印等物品上，用于记录事物与事物之间关系和区别。随着时代的发展，版本也开始使用在影视，软件等虚拟物品上。

软件版本编号，指以数字的形式制定软件的先后顺序及版本标志。如node 17.6.0,QQ Windows版9.5.6，QQ Mac Version6.7.5 ，alipay 10.2.53等。

### 版本号的含义

主版本号.次版本号.修订号

主版本号：增加新功能

次版本号：优化功能

修订号：修复版本BUG

### 版本管理

#### 传统方式

建立多个项目文件，文件多，管理繁琐，维护复杂。

#### 新型方式（版本控制方式）

版本控制软件是一个用来记录文件变化，以便将来查阅特定版本修订情况的系统，因此有时也叫做“版本控制系统”。改变传统方式维护软件的弊端。

使用版本控制以后，只需在本地保存一份，各个版本由版本控制软件来进行管理，常见的版本控制软件有git和svn。

## Git简介

### 概念

Git 是一个开源的分布式版本控制系统，可以快速有效、高效地处理从很小到非常大的项目版本管理，对项目代码进行维护、管理、控制等操作，是团队协作开发过程中常用的版本管理工具之一（另一个是SVN）。

### 特点

高性能和高可用性（项目越大，特点越明显）。

### 区域划分

工作区、暂存区、Git仓库(本地仓库，远程仓库)

工作区：编写项目功能代码的工作区域。

暂存区：已完成的工作，临时存放的区域，等待被提交。

Git仓库区：最终存放的区域。

\*\*注：\*\*git管理提交仓库，只能按顺序 工作区=>暂存区=>Git仓库区

### Git工作流程

![](../img/git\_pic/Git工作流程图.png)

## Git下载

下载地址：https://git-scm.com/downloads

## Git配置和操作

### 用户基本信息的配置

**查看配置信息**

```
git config [--local/--global/--system] --list
```

\--local，查看本地仓库配置信息；--global，查看当前用户全局配置信息；--system，查看系统配置信息。

**设置用户名**

```
git config --global user.name "你的名字或昵称"
```

**设置邮箱**

```
git config --global user.email "你的邮箱"
```

\*\*注：\*\*执行配置用户信息命令后，信息会被写入到C:/Users/计算机名/.gitconfig文件中，一次配置永久生效。

**删除全局配置信息**

```
git config --global --unset user.name
```

### Git操作基础步骤演示

1.初始化项目，以便使用Git命令。

```
git init
```

\*\*注：\*\*每个项目只需要初始化一次。初始化后会生成一个.git隐藏文件夹，不能删除，不能更改，否则会导致git命令失效。

2.编写项目代码

3.将工作区内容提交到暂存区

```
git add . /文件名.后缀
```

4.将暂存区内容提交到本地仓库区

```
git commit -m "提交信息"
```

注：工作区=>暂存区=>本地仓库

如果有修改文件的时候，不按照命令流，则会提示，先提交暂存区，在提交仓库。

如果没有修改文件的时候，则提示，暂无需要提交的内容。

## Git常用命令

#### init

初始化Git工具

```
git init
```

#### add

将工作区的内容提交到暂存区

```
git add . / 文件名(带后缀)
```

#### commit

将暂存区的内容提交到本地仓库

```
git commit -m "提交信息"
```

#### status

显示本次操作工作区和暂存区的状态

```
git status [-s]
```

\-s，简短查询状态。

#### reset

回退指定提交版本

```
git reset [--hard/--soft/--mixed]  指定版本号< HEAD ~(num) > | <commit ID> | HEAD^
```

\--hard，缓存区和工作区都同步到你指定的版本；

\--mixed，默认参数，缓存区同步到你指定的版本，保留工作区；

\--soft，保留缓存区和工作区；

#### revert

**版本回滚**

```
git revert 指定版本号< HEAD ~(num) > | <commit ID> | HEAD^
```

**批量回滚**

```
git revert older_commit^..newer_commit
```

**git reset 和 git revert 区别**

采用 git reset 会使 HEAD 指针往回移动，从而会失去之后的提交信息。 采用 git revert 是把指定版本内容，生成一个新的 commit 版本，不影响 commit 版本之前及之后的提交，HEAD 指针是指向这个新的版本。

#### log

查询历史提交成功记录日志信息（可以简版查询，详版查询，指定条数）

```
gitlog [--oneline [-数字] ]
```

\--oneline，显示最近5次日志。

\-数字，指定显示次数。

**以GUI工具的形式展示日志**

```
git log --graph --date=relative --pretty=tformat:'%Cred%h%Creset-%C(auto)%d%Creset %s %Cgreen(%an %ad)%Creset'
```

#### reflog

查看本地git操作历史记录

```
git reflog
```

## Git文件忽略

对于私有文件/文件夹(无需git进行管理）可以将其配置为忽略文件模式，则提交仓库时，文件会被忽略提交。

**.gitignore配置文件**：用来配置需要忽略的文件/文件夹

### 文件配置规则：

1、/demo/ 忽略整个文件夹

2、\*.txt 忽略指定类型的文件

3、/demo/index.html 忽略指定文件

\*\*注：\*\*修改配置文件后，必须要再次提交才会生效。

### 案例：

当项目中某个文件/文件夹，已不需使用，但该文件已经在仓库中存在记录，此时再设置忽略文件，该规则将会失效，那么此时如何操作，可以生效该规则？

1、删除仓库缓存索引

```
git rm  --cached “忽略文件的规则的文件名” 
```

2、提交删除生效

```
git commit –m “删除注释” 
```

**注：**--cached 只会删除索引，不会删除本地文件。

## Git分支

在进行多人协作开发过程中，为了防止互相干扰，提高协同开发体验，引入了分支概念。

### Git分支分类

主分支：初始化本地Git仓库的时候，默认会创建一个名字为master的分支，通常称这个分支为主分支。

自定义分支：用户可以根据自己的模块，创建自己的分支，进行协同开发。

### 分支操作基础命令

#### branch

**查看分支**

```
git branch [-a/-r/-v]
```

–r，查看远程分支；–a，查看本地和远程；–v，查看各个分支最后一次提交信息。

**创建本地分支**

```
git branch 分支名字(branch_name)
```

**删除本地分支**

```
git branch -d 分支名字(branch-name)
```

**重命名本地分支**

```
git branch -m 原分支名(oldbranch-name)  新分支名(newbranch-name)
```

#### checkout

**切换到指定分支**

```
git checkout 分支名字(branch_name)
```

**创建新分支并切换到当前分支**

```
git checkout -b 分支名字(branch-name)
```

**创建一个空分支**

```
git checkout --orphan 分支名字(emptyBranchName) &&  git rm -rf .
```

#### merge

**指定分支合并到当前分支**

```
git merge [分支名字(branch-name)]
```

**合并分支时生成一个新的commit记录**

```
git merge --no-ff -m "提交信息"  分支名字(branch-name)
```

**查看那些分支没有合并到当前分支**

```
git branch --no-merged
```

### 分支冲突

**产生冲突操作：**

如果在两个不同的分支中，对同一个文件进行了不同的修改，分别将两个分支合并到主分支上，当合并第二个分支的时候就会产生分支冲突。

**解决方案：**

当本地仓库产生冲突的时候，开发环境会把两个内容全部显示，手动更改/选择更改即可。

当远程仓库产生冲突的时候，开发环境会提示重新拉取项目，拉取后会把两个内容全部显示，手动更改/选择更改即可。

## 远程仓库

Git 命令都是在本地执行。在进行多人协作开发过程中，如果代码是共享式开发，则需要将代码放到一台其他开发人员能够连接的服务器上，这台服务器称为远程仓库。

### 远程仓库分类：

#### github

github是一个基于git的代码托管平台，服务器在国外，相对速度比较慢。

#### gitee(码云)

gitee是一个基于git的代码托管平台，国产平台，服务器在国内。

#### 公司部署

各个大中型公司都有自己公司内部的服务器仓库。

### 案例

#### 码云远程仓库操作步骤

官网：https://gitee.com/

1.注册，并登录

2.创建远程仓库

(1)点击页面右上角的 + 号，点击新建仓库，添加仓库信息。包含仓库名称和路径，点击创建，完成远程仓库的创建。

(2)点击我的，左侧选项卡仓库右边的+ 号，点击新建仓库，添加仓库信息。包含仓库名称和路径，点击创建，完成远程仓库的创建。

\*\*注：\*\*现在码云创建新仓库，只能是私有仓库(只能容纳5个成员)，在仓库设置中可以修改为公开仓库。

3.将本地文件推送到远程仓库。

4.克隆/同步远程仓库。

\*\*案例一：\*\*将本地项目与远程仓库进行关联绑定

```
1、初始化本地文件夹Git管理
git init
2、将本地文件夹与远程仓库绑定
git remote add 仓库别名(默认是origin)  远程仓库地址(git-repo-url)
3、拉取远程仓库内容和分支
git pull 远程仓库地址
4、本地创建一个与远程仓库同名的分支
git branch 分支名
5、切换分支
git checkout 分支名
6、修改工作区文件
7、将工作区文件提交到暂存区
git add .
8、将暂存区文件提交到本地仓库
git commit -m "提交信息"
9、将本地仓库文件提交到远程仓库
git push --set-upstream origin(远程仓库别名) 分支名
或者
git push 远程仓库地址
```

\*\*案例二：\*\*克隆远程仓库

```
1、将远程仓库克隆到本地
git clone 远程仓库地址(git-repo-url)
2、修改工作区文件
3、将工作区文件提交到暂存区
git add .
4、将暂存区文件提交到本地仓库
git commit -m "提交信息"
5、将本地仓库文件提交到远程仓库
git push
```

\*\*案例三：\*\*使用远程分支上传代码

```
1、查看本地是否已存在远程分支
git branch
2、如果本地没有则需要拉取远程分支
git pull
3、切换到远程分支
git checkout origin/分支名
4、查看是否切换成功
git branch
5、修改工作区内容
6、将工作区文件提交到暂存区
git add .
7、将暂存区文件提交到本地仓库
git commit -m "提交信息"
8、将本地仓库文件提交到远程仓库
git push origin HEAD:分支名
```

### 常用命令

#### remote

**add**

将远程仓库绑定到本地当前文件夹，并建立关联

```
git remote add 仓库别名(默认是origin)  远程仓库地址(git-repo-url)
```

**-v**

查询本地与远程仓库的别名及远程仓库的地址

```
git remote -v
```

#### push

**将本地内容推送到远程仓库**

```
git push [远程地址] /  git push  [-u]  [远程仓库别名/分支名]
```

\*\*注：\*\*如果使用-u参数，则第2次及以后可以直接使用git push把本地推送到远程仓库，但账号和密码必须正确。

**删除远程仓库分支**

```
git push origin -d分支名字(branch-name)
```

\*\*注：\*\*删除分支前都需要先切换到其他分支才能进行删除操作

#### clone

克隆远程仓库

```
git clone 远程仓库地址
```

克隆到指定文件夹下

```
git clone 远程仓库地址(git-repo-url)  指定文件夹名
```

#### pull

拉取远程仓库的更新，包括分支信息和文件内容

```
git pull 远程仓库地址
```

\*\*注：\*\*上(班)pull,下(班)push

#### fetch

**将某个远程主机的所有更新，全部拉取到本地**

```
git fetch origin && git merge origin/分支
```

**取回特定分支更新的数据**

```
git fetch origin 分支名 && git merge origin/分支
```

#### help

显示Git的帮助信息

```
git help
```

## SSH访问

### SSH访问好处

当采用SSH模式登录，可以免除登录身份认证，且数据是加密传输。

### SSH组成

id\_rsa 私钥文件（存放于开发者电脑）和id\_rsa.pub 公钥文件 。

### SSH的使用

#### SSH生成步骤

1、打开Git Bash

2、执行相关命令

3、连续敲击3 次回车

**生成命令**

**ssh-keygen**

生成公钥和密钥,同时将密钥保存在C:\Users\计算机名.ssh文件中

```
ssh-keygen -t rsa -b 4096 -C "your_email@example.com"
```

**ssh**

检测Github 的SSH key 是否配置成功。

```
ssh -T git@gitee.com
```

#### 配置SSH步骤

(1)使用记事本打开id\_rsa.pub文件，复制里面的文本内容

(2)登录gitee，点击头像-> 设置-> 安全设置:SSH公钥 -> 添加公钥

(3)将id\_rsa.pub 文件中的内容，粘贴到公钥 对应的文本框中

(4)在Title 文本框中任意填写一个名称，来标识这个Key 的所有者。

## Git与SVN区别

### SVN

SVN是一个开放源代码的集中式版本控制系统，用于多个人共同开发同一个项目，实现共享资源。集中式版本控制系统：版本库是集中存放在中央服务器，开发者需要先从中央服务器获取最新的版本文件，最后再把自己修改的文件推送到中央服务器。

![](<../.gitbook/assets/SVN集中式服务器 (1).jpg>)

### Git

Git是一个开源的分布式版本控制系统，是目前比较流行的版本控制系统。可以快速高效地处理从很小到非常大的项目版本管理。采用分布式版本控制系统：没有“中央服务器”，每个人的电脑上都是一个完整的版本库，不需要联网开发，但需要采用云端/公共服务器进行多人开发的项目整合（gitee和github）。

![](<../.gitbook/assets/Git分布式服务器 (1).jpg>)
